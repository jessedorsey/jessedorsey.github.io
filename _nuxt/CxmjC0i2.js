import{f as D,a6 as N,a7 as q,b as v,e as I,d as C,q as M}from"./C-c69ZSP.js";function E(t,e){const r=e/t*100;return 2/Math.PI*100*Math.atan(r/50)}function H(t={}){const{duration:e=2e3,throttle:r=200,hideDelay:l=500,resetDelay:c=400}=t,d=t.estimatedProgress||E,u=D(),a=v(0),n=v(!1),m=v(!1);let h=!1,p,y,T,_;const b=(o={})=>{P(),m.value=!1,L(0,o)};function L(o=0,i={}){if(u.isHydrating)return;if(o>=100)return f({force:i.force});g(),a.value=o<0?0:o;const s=i.force?0:r;s?y=setTimeout(()=>{n.value=!0,k()},s):(n.value=!0,k())}function S(){T=setTimeout(()=>{n.value=!1,_=setTimeout(()=>{a.value=0},c)},l)}function f(o={}){a.value=100,h=!0,g(),P(),o.error&&(m.value=!0),o.force?(a.value=0,n.value=!1):S()}function P(){clearTimeout(T),clearTimeout(_)}function g(){clearTimeout(y),cancelAnimationFrame(p)}function k(){h=!1;let o;function i(s){if(h)return;o??(o=s);const F=s-o;a.value=Math.max(0,Math.min(100,d(e,F))),p=requestAnimationFrame(i)}p=requestAnimationFrame(i)}let x=()=>{};{const o=u.hook("page:loading:start",()=>{b()}),i=u.hook("page:loading:end",()=>{f()}),s=u.hook("vue:error",()=>f());x=()=>{s(),o(),i(),g()}}return{_cleanup:x,progress:I(()=>a.value),isLoading:I(()=>n.value),error:I(()=>m.value),start:b,set:L,finish:f,clear:g}}function $(t={}){const e=D(),r=e._loadingIndicator||(e._loadingIndicator=H(t));return N()&&(e._loadingIndicatorDeps||(e._loadingIndicatorDeps=0),e._loadingIndicatorDeps++,q(()=>{e._loadingIndicatorDeps--,e._loadingIndicatorDeps===0&&(r._cleanup(),delete e._loadingIndicator)})),r}const A=C({name:"NuxtLoadingIndicator",props:{throttle:{type:Number,default:200},duration:{type:Number,default:2e3},height:{type:Number,default:3},color:{type:[String,Boolean],default:"repeating-linear-gradient(to right,#00dc82 0%,#34cdfe 50%,#0047e1 100%)"},errorColor:{type:String,default:"repeating-linear-gradient(to right,#f87171 0%,#ef4444 100%)"},estimatedProgress:{type:Function,required:!1}},setup(t,{slots:e,expose:r}){const{progress:l,isLoading:c,error:d,start:u,finish:a,clear:n}=$({duration:t.duration,throttle:t.throttle,estimatedProgress:t.estimatedProgress});return r({progress:l,isLoading:c,error:d,start:u,finish:a,clear:n}),()=>M("div",{class:"nuxt-loading-indicator",style:{position:"fixed",top:0,right:0,left:0,pointerEvents:"none",width:"auto",height:`${t.height}px`,opacity:c.value?1:0,background:d.value?t.errorColor:t.color||void 0,backgroundSize:`${100/l.value*100}% auto`,transform:`scaleX(${l.value}%)`,transformOrigin:"left",transition:"transform 0.1s, height 0.4s, opacity 0.4s",zIndex:999999}},e)}});export{A as default};
